

<?xml version="1.0" encoding="utf-8" ?>
<ContentView
    x:Class="OrderEntry.Components.PaymentMenu"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:buttons="clr-namespace:Syncfusion.Maui.Buttons;assembly=Syncfusion.Maui.Buttons"
    xmlns:model="clr-namespace:Data.Models.Entities.Menu;assembly=Data.Models"
    xmlns:receipt="clr-namespace:OrderEntry.Components.Receipt.Views"
    xmlns:sflistView="clr-namespace:Syncfusion.Maui.ListView;assembly=Syncfusion.Maui.ListView"
    xmlns:vm="clr-namespace:OrderEntry.ViewModels.MenuServiceVMpartialClasses"
    xmlns:vm2="clr-namespace:OrderEntry.ViewModels"
    x:DataType="vm:MenuServiceViewModel">
    <ContentView.Resources>
        <Style x:Key="IconButton" TargetType="buttons:SfButton">
            <Setter Property="CornerRadius" Value="5" />
            <Setter Property="ImageSize" Value="25" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="ShowIcon" Value="True" />
            <Setter Property="TextColor" Value="Black" />
            <Setter Property="Background" Value="LightGray" />
        </Style>
        <Style
            x:Key="IconButtonWhite"
            BasedOn="{StaticResource IconButton}"
            TargetType="buttons:SfButton">
            <Setter Property="Background" Value="White" />
            <Setter Property="CornerRadius" Value="15" />
            <Setter Property="TextColor" Value="Black" />
        </Style>

        <Style x:Key="LabelBaseStyle" TargetType="Label">
            <Setter Property="FontSize" Value="{OnIdiom Desktop=14}" />
            <Setter Property="VerticalOptions" Value="Center" />
            <Setter Property="VerticalTextAlignment" Value="Center" />
        </Style>
    </ContentView.Resources>

    <Grid Margin="10,5" RowDefinitions="auto,*,auto">

        <Border
            Margin="0,0,1,0"
            Padding="10,5,10,5"
            Background="WhiteSmoke"
            StrokeShape="RoundRectangle 15,15,0,0">
            <Grid Margin="0,0" ColumnDefinitions="auto,auto,*,auto,auto">
                <buttons:SfButton
                    Margin="2"
                    Padding="0,0,0,0"
                    Background="Transparent"
                    Command="{Binding BackCommand}"
                    ImageAlignment="Default"
                    ImageSource="keyboard_back1.png"
                    MaximumWidthRequest="40"
                    Style="{StaticResource IconButton}" />
                <Label
                    Grid.Column="1"
                    MinimumWidthRequest="50"
                    Style="{StaticResource LabelBaseStyle}"
                    Text="#2" />
                <Label
                    Grid.Column="2"
                    Style="{StaticResource LabelBaseStyle}"
                    Text="Hammad khan" />

                <buttons:SfButton
                    Grid.Column="4"
                    Margin="2"
                    ImageAlignment="Default"
                    ImageSize="20"
                    ImageSource="verticalline.png"
                    MaximumWidthRequest="40"
                    Style="{StaticResource IconButton}" />


            </Grid>
        </Border>
        <Grid Grid.Row="1" RowDefinitions="*,auto,auto">
            <Border
                Grid.Row="0"
                Margin="0,0,1,0"
                Padding="10,0"
                Background="WhiteSmoke"
                MaximumHeightRequest="300"
                MinimumHeightRequest="100"
                StrokeShape="RoundRectangle 0,0,0,0">
                <Grid RowDefinitions="*,35">
                    <ScrollView>

                        <receipt:ReceiptView
                            ItemsSource="{Binding Controller.Items}"
                            MaximumHeightRequest="260"
                            SelectedItems="{Binding Controller.SelectedItems}"
                            VerticalOptions="StartAndExpand" />
                    </ScrollView>
                    <Label
                        Grid.Row="1"
                        Margin="0,0,10,0"
                        HorizontalOptions="End"
                        Style="{StaticResource LabelBaseStyle}"
                        Text="Sun 1:34 PM" />
                </Grid>
            </Border>
            <Label
                Grid.Row="1"
                Margin="10,0,0,0"
                Style="{StaticResource LabelBaseStyle}"
                Text="PAYMENT" />
            <Border
                Grid.Row="2"
                Margin="0,1,1,0"
                Padding="0"
                Background="WhiteSmoke"
                StrokeShape="RoundRectangle 0,0,0,0">
                <Grid Margin="0,0,20,0" ColumnDefinitions="0.2*,*">
                    <Grid
                        Grid.Column="1"
                        Margin="0,10"
                        RowDefinitions="30,30,30,2,30,30,30,*">
                        <Grid ColumnDefinitions="auto,*,100">
                            <Label Style="{StaticResource LabelBaseStyle}" Text="{Binding Controller.SubTotalText, UpdateSourceEventName=PropertyChanged}" />
                            <Label
                                Grid.Column="2"
                                Style="{StaticResource LabelBaseStyle}"
                                Text="{Binding Controller.SubTotal, UpdateSourceEventName=PropertyChanged, StringFormat='{}{0:C2}'}" />
                        </Grid>
                        <Grid Grid.Row="1" ColumnDefinitions="80,*,100">
                            <Label Style="{StaticResource LabelBaseStyle}" Text="Total Tax:" />
                            <Label
                                Grid.Column="2"
                                Style="{StaticResource LabelBaseStyle}"
                                Text="{Binding Controller.TotalTax, UpdateSourceEventName=PropertyChanged, StringFormat='{}{0:C2}'}" />
                        </Grid>
                        <Grid Grid.Row="2" ColumnDefinitions="auto,*,100">
                            <Label
                                FontAttributes="Bold"
                                Style="{StaticResource LabelBaseStyle}"
                                Text="Total Discount:" />
                            <Label
                                Grid.Column="2"
                                Margin="-5,0,0,0"
                                Style="{StaticResource LabelBaseStyle}">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span FontSize="14" Text="-" />
                                        <Span FontSize="14" Text="{Binding Controller.GrandTotalDiscount, UpdateSourceEventName=PropertyChanged, StringFormat='{}{0:C2}'}" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                        </Grid>
                        <Grid Grid.Row="3" Background="LightPink" />
                        <Grid Grid.Row="4" ColumnDefinitions="80,*,100">
                            <Label Style="{StaticResource LabelBaseStyle}" Text="Total:" />
                            <Label
                                Grid.Column="2"
                                Style="{StaticResource LabelBaseStyle}"
                                Text="{Binding Controller.GrandTotal, StringFormat='{}{0:C2}'}" />
                        </Grid>
                        <Grid Grid.Row="5" ColumnDefinitions="auto,*,100">
                            <Grid.Triggers>
                                <DataTrigger
                                    Binding="{Binding Controller.CouponAmount}"
                                    TargetType="Grid"
                                    Value="0">
                                    <Setter Property="IsVisible" Value="False" />
                                </DataTrigger>
                            </Grid.Triggers>
                            <Label Style="{StaticResource LabelBaseStyle}">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="Coupon:" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                            <Label Grid.Column="2" Style="{StaticResource LabelBaseStyle}">
                                <Label.FormattedText>
                                    <FormattedString>
                                        <Span Text="-" />
                                        <Span Text="{Binding Controller.CouponAmount, StringFormat='{}{0:C2}'}" />
                                    </FormattedString>
                                </Label.FormattedText>
                            </Label>
                        </Grid>
                        <Grid Grid.Row="6" ColumnDefinitions="120,*,100">
                            <Label
                                FontAttributes="Bold"
                                Style="{StaticResource LabelBaseStyle}"
                                Text="Balance Due:" />
                            <Label
                                Grid.Column="2"
                                Style="{StaticResource LabelBaseStyle}"
                                Text="{Binding Controller.TotalDue, UpdateSourceEventName=PropertyChanged, StringFormat='{}{0:C2}'}" />
                        </Grid>

                    </Grid>
                </Grid>
            </Border>
        </Grid>
        <Border
            Grid.Row="2"
            Margin="0,0,0,0"
            Padding="0"
            Background="WhiteSmoke"
            MaximumHeightRequest="120"
            MinimumHeightRequest="70"
            StrokeShape="RoundRectangle 0,0,15,15">
            <Grid Padding="20,10" RowDefinitions="auto,auto,auto">
                <Grid
                    Grid.Row="0"
                    Margin="0,0,0,0"
                    BackgroundColor="PaleVioletRed"
                    HeightRequest="40"
                    IsVisible="{Binding IsTestMode}">
                    <Label HorizontalTextAlignment="Center" VerticalOptions="Center">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span FontAttributes="Bold" Text="TEST MODE:" />
                                <Span Text="PAYMENTS WILL NOT PROCESSED" />
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>

                </Grid>


                <buttons:SfButton
                    Grid.Row="1"
                    Margin="0,5,0,0"
                  IsVisible="False"
                    Background="LightGray"
                    Command="{Binding CashDoneCommand}"
                    CornerRadius="7"
                    FontAttributes="Bold"
                    Style="{StaticResource IconButtonWhite}"
                    Text="Done"
                    TextColor="Black" />
            </Grid>
        </Border>


    </Grid>
</ContentView>